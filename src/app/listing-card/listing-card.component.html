<div class="card h-100">
  <div class="card-body d-flex flex-column">

    <!-- Title and Favorite Button -->
    <div class="d-flex justify-content-between align-items-center mb-2">
      <h5 class="card-title mb-0">{{ listing.title }}</h5>
      <button
        type="button"
        class="btn btn-link p-0"
        (click)="toggleFavorite()"
        [title]="isFavorite ? 'Remove from favorites' : 'Add to favorites'">
        <i class="bi" [ngClass]="{'bi-heart-fill text-danger': isFavorite, 'bi-heart': !isFavorite}"></i>
      </button>
    </div>

     <p><strong>Apartment / Building:</strong> {{ listing.apartmentSelection }}</p>
          <p><strong>Property Name:</strong> {{ listing.propertyName }}</p>
          <p><strong>Shared Property:</strong> {{ listing.isShared === 'yes' ? 'Yes' : 'No' }}</p>
          <p><strong>Location:</strong> {{ listing.location }}</p>
          <p><strong>Square Footage:</strong> {{ listing.squareFootage }} sq ft</p>
          <p><strong>Lease Type:</strong> {{ listing.leaseType | titlecase }}</p>
          <p><strong>Price:</strong> R{{ listing.price }} <span *ngIf="listing.isNegotiable">(Negotiable)</span></p>
          <p><strong>Furnished:</strong> {{ listing.furnished ? 'Yes' : 'No' }}</p>
          <p><strong>Vegetarian Preference:</strong> {{ listing.vegetarianPreferred ? 'Yes' : 'No' }}</p>
          <p><strong>Amenities:</strong> {{ listing.amenities.join(', ') }}</p>
          <p><strong>Description:</strong> {{ listing.description }}</p>


    <!-- Image -->
    <img
      *ngIf="listing.imageUrl"
      [src]="listing.imageUrl"
      class="img-fluid rounded mb-3"
      alt="Listing Image"
      style="max-height: 200px; object-fit: cover; width: 100%;" />

    <!-- Comments Section -->
    <div class="mt-auto">
      <h6>Comments:</h6>
      <ul class="list-group mb-3" style="max-height: 150px; overflow-y: auto;">
        <li *ngFor="let comment of comments" class="list-group-item py-1">
          <strong>{{ comment.userEmail }}</strong>: {{ comment.content }}
          <br />
          <small class="text-muted">{{ comment.timestamp | date:'short' }}</small>
        </li>
      </ul>

      <!-- Add Comment Input -->
      <div class="input-group">
        <input
          type="text"
          class="form-control"
          placeholder="Add a comment..."
          [(ngModel)]="newComment" />
        <button
          class="btn btn-primary"
          (click)="addComment()"
          [disabled]="!newComment.trim()">
          Comment
        </button>
      </div>
    </div>

    <!-- Optional Go to Favourites Button -->
    <button
      *ngIf="showGoToFavourites"
      routerLink="/favourites"
      class="btn btn-outline-success mt-3 w-100">
      Go to Favourites
    </button>
  </div>
</div>
